<!DOCTYPE html>
<html>
<head>
    <title>Glyph inspector</title>
    <meta charset="utf-8">
    <script src="../bower_components/opentype.js/dist/opentype.js"></script>
</head>
<body>
<div class="container">
    <div id="glyph-display">
        <canvas id="glyph" width="500" height="500" style="background-color: palegoldenrod;"></canvas>
    </div>
</div>
<script>
    function displayGlyph(width, height, ctx, glyph, font) {
        var hhea = font.tables.hhea,
                maxHeight = hhea.ascender - hhea.descender;
        var glyphScale = Math.min(height/maxHeight, hhea.advanceWidthMax);
        var glyphSize = glyphScale * font.unitsPerEm;
        var glyphBaseline = height * hhea.ascender / maxHeight;
        function hline(text, yunits) {
            ypx = glyphBaseline - yunits * glyphScale;
            ctx.fillText(text, 2, ypx+3);
            ctx.fillRect(80, ypx, width, 1);
        }
        ctx.clearRect(0, 0, width, height);
        ctx.fillStyle = '#a0a0a0';
        hline('Baseline', 0);
        hline('Ascender', font.tables.hhea.ascender);
        hline('Descender', font.tables.hhea.descender);
        var glyphWidth = glyph.advanceWidth * glyphScale,
                xmin = (width - glyphWidth)/2,
                xmax = (width + glyphWidth)/2,
                x0 = xmin,
                markSize = 10;
        ctx.fillStyle = '#606060';
        glyph.draw(ctx, x0, glyphBaseline, glyphSize);
    }
    function onFontLoaded(font) {
        window.font = font;
        var glyph = font.glyphs[12];
        var glyphCanvas = document.getElementById('glyph');
        displayGlyph(glyphCanvas.width, glyphCanvas.height, glyphCanvas.getContext('2d'), glyph, window.font);
    }
    opentype.load('latinmodern-math.otf', function (err, font) {
        onFontLoaded(font);
    });
</script>
</body>
</html>